import"./svelte/svelte_internal_flags_async.js";import{untrack as Ce,tick as Re}from"./svelte/svelte_svelte.js";import*as e from"./svelte/svelte_internal_client.js";import{spring as Fe}from"./svelte/svelte_motion.js";import{I as je,p as Te,a1 as Ue,a2 as He,a3 as Ge,a4 as Oe,a5 as We}from"./ScrollFade-Z5OOjlGL.js";import"./svelte/svelte_internal_flags_legacy.js";import"./i18n-B4hKvn1K.js";import{A as Je}from"./MarkdownCode-DBmitoTT.js";import{fade as qe,slide as Ke}from"./svelte/svelte_transition.js";function ye(l){let t=["","k","M","G","T","P","E","Z"],a=0;for(;l>1e3&&a<t.length-1;)l/=1e3,a++;let i=t[a];return(Number.isInteger(l)?l:l.toFixed(1))+i}var Qe=e.from_html('<div><svg viewBox="-1200 -1200 3000 3000" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-1vhirvf"><g><path d="M255.926 0.754768L509.702 139.936V221.027L255.926 81.8465V0.754768Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M509.69 139.936L254.981 279.641V361.255L509.69 221.55V139.936Z" fill="#FF7C00" class="svelte-1vhirvf"></path><path d="M0.250138 139.937L254.981 279.641V361.255L0.250138 221.55V139.937Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M255.923 0.232622L0.236328 139.936V221.55L255.923 81.8469V0.232622Z" fill="#FF7C00" class="svelte-1vhirvf"></path></g><g><path d="M255.926 141.5L509.702 280.681V361.773L255.926 222.592V141.5Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M509.69 280.679L254.981 420.384V501.998L509.69 362.293V280.679Z" fill="#FF7C00" class="svelte-1vhirvf"></path><path d="M0.250138 280.681L254.981 420.386V502L0.250138 362.295V280.681Z" fill="#FF7C00" fill-opacity="0.4" class="svelte-1vhirvf"></path><path d="M255.923 140.977L0.236328 280.68V362.294L255.923 222.591V140.977Z" fill="#FF7C00" class="svelte-1vhirvf"></path></g></svg></div>');function $e(l,t){e.push(t,!0);const a=()=>e.store_get(n,"$top",p),i=()=>e.store_get(m,"$bottom",p),[p,v]=e.setup_stores();let y=e.prop(t,"margin",3,!0);const n=Fe([0,0]),m=Fe([0,0]);let z=e.state(!1);async function E(){await Promise.all([n.set([125,140]),m.set([-125,-140])]),await Promise.all([n.set([-125,140]),m.set([125,-140])]),await Promise.all([n.set([-125,0]),m.set([125,-0])]),await Promise.all([n.set([125,0]),m.set([-125,0])])}async function T(){await E(),e.get(z)||T()}async function h(){await Promise.all([n.set([125,0]),m.set([-125,0])]),T()}e.user_effect(()=>(h(),()=>{e.set(z,!0)}));var s=Qe();let x;var k=e.child(s),q=e.child(k),X=e.sibling(q);e.reset(k),e.reset(s),e.template_effect(()=>{x=e.set_class(s,1,"svelte-1vhirvf",null,x,{margin:y()}),e.set_style(q,`transform: translate(${a()[0]??""}px, ${a()[1]??""}px);`),e.set_style(X,`transform: translate(${i()[0]??""}px, ${i()[1]??""}px);`)}),e.append(l,s),e.pop(),v()}let me=[],we=!1;const et=typeof window<"u",Ae=et?window.requestAnimationFrame:l=>{};async function tt(l,t=!0){if(!(window.__gradio_mode__==="website"||window.__gradio_mode__!=="app"&&t!==!0)){if(me.push(l),!we)we=!0;else return;await Re(),Ae(()=>{let a=[0,0];for(let i=0;i<me.length;i++){const v=me[i].getBoundingClientRect();(i===0||v.top+window.scrollY<=a[0])&&(a[0]=v.top+window.scrollY,a[1]=i)}window.scrollTo({top:a[0]-20,behavior:"smooth"}),we=!1,me=[]})}}var at=e.from_html('<div class="validation-error svelte-1uj8rng"> <button class="svelte-1uj8rng"><!></button></div>'),rt=e.from_html('<div class="eta-bar svelte-1uj8rng"></div>'),st=e.from_html("<!> ",1),lt=e.from_html("<!> <!> <!> <!>",1),it=e.from_html('<div class="progress-level svelte-1uj8rng"><div class="progress-level-inner svelte-1uj8rng"><!></div> <div class="progress-bar-wrap svelte-1uj8rng"><div class="progress-bar svelte-1uj8rng"></div></div></div>'),nt=e.from_html('<p class="loading svelte-1uj8rng"> </p> <!>',1),ot=e.from_html("<!> <div><!> <!></div> <!> <!>",1),dt=e.from_html('<div class="clear-status svelte-1uj8rng"><!></div> <span class="error svelte-1uj8rng"> </span> <!>',1),vt=e.from_html('<div data-testid="status-tracker"><!> <!></div>');function qt(l,t){e.push(t,!0);let a=e.prop(t,"eta",7,null),i=e.prop(t,"scroll_to_output",3,!1),p=e.prop(t,"timer",3,!0),v=e.prop(t,"show_progress",3,"full"),y=e.prop(t,"message",3,null),n=e.prop(t,"progress",3,null),m=e.prop(t,"variant",3,"default"),z=e.prop(t,"loading_text",3,"Loading..."),E=e.prop(t,"absolute",3,!0),T=e.prop(t,"translucent",3,!1),h=e.prop(t,"border",3,!1),s=e.prop(t,"validation_error",7,null),x=e.prop(t,"show_validation_error",3,!0),k=e.prop(t,"type",3,null),q,X=!1,se=e.state(0),b=e.state(null),A=e.state(null),O=e.state(!1),K=e.state(null);const pe=e.derived(()=>k()==="input"||!t.status||t.status==="complete"||v()==="hidden"||t.status=="streaming"||!!(x()&&s()));let Q=e.state(0);const le=e.derived(()=>e.get(A)===null||e.get(A)<=0||!e.get(Q)?0:Math.min(e.get(Q)/e.get(A),1)),$=e.derived(()=>e.get(Q).toFixed(1));let fe=e.derived(()=>n()==null);function _e(){Ae(()=>{e.set(Q,(performance.now()-e.get(se))/1e3),X&&_e()})}let I=e.derived(()=>{let o=null;n()!=null?o=n().map(_=>{if(_.index!=null&&_.length!=null)return _.index/_.length;if(_.progress!=null)return _.progress}):o=null;let u,f="";return o?(u=o[o.length-1],u===0?f="0":f="150ms"):u=void 0,{progress_level:o,last_progress_level:u,progress_bar_transition:f}});function ie(){X||(e.set(b,e.set(K,null),!0),e.set(se,performance.now(),!0),X=!0,_e())}function ce(){e.set(b,e.set(K,null),!0),X&&(X=!1)}e.user_effect(()=>{t.status==="pending"?ie():Ce(()=>{ce()})}),e.user_effect(()=>{q&&i()&&(t.status==="pending"||t.status==="complete")&&tt(q,t.autoscroll)}),e.user_effect(()=>{a()===null&&a(e.get(b)),a()!=null&&e.get(b)!==a()&&(e.set(A,(performance.now()-e.get(se))/1e3+a()),e.set(K,e.get(A).toFixed(1),!0),e.set(b,a(),!0))});function he(){e.set(O,!1)}e.user_effect(()=>{Ce(()=>{he()}),t.status==="error"&&y()&&e.set(O,!0)});var Y=vt();let ne,ue;var ge=e.child(Y);{var xe=o=>{var u=at(),f=e.child(u),_=e.sibling(f),w=e.child(_);{let Z=e.derived(()=>t.i18n?t.i18n("common.clear"):"Clear");je(w,{get Icon(){return Te},get label(){return e.get(Z)},disabled:!1,size:"x-small",background:"var(--background-fill-primary)",color:"var(--error-background-text)",border:"var(--border-color-primary)",onclick:()=>s(null)})}e.reset(_),e.reset(u),e.template_effect(()=>e.set_text(f,`${s()??""} `)),e.append(o,u)};e.if(ge,o=>{s()&&x()&&o(xe)})}var r=e.sibling(ge,2);{var g=o=>{var u=ot(),f=e.first_child(u);{var _=d=>{var c=rt();let F;e.template_effect(()=>F=e.set_style(c,"",F,{transform:`translateX(${(e.get(le)||0)*100-100}%)`})),e.append(d,c)};e.if(f,d=>{m()==="default"&&e.get(fe)&&v()==="full"&&d(_)})}var w=e.sibling(f,2);let Z;var S=e.child(w);{var C=d=>{var c=e.comment(),F=e.first_child(c);e.each(F,17,n,e.index,(D,L)=>{var V=e.comment(),N=e.first_child(V);{var ee=R=>{var U=st(),te=e.first_child(U);{var be=H=>{var J=e.text();e.template_effect((de,ve)=>e.set_text(J,`${de??""}/${ve??""}`),[()=>ye(e.get(L).index||0),()=>ye(e.get(L).length)]),e.append(H,J)},ae=H=>{var J=e.text();e.template_effect(de=>e.set_text(J,de),[()=>ye(e.get(L).index||0)]),e.append(H,J)};e.if(te,H=>{e.get(L).length!=null?H(be):H(ae,!1)})}var re=e.sibling(te);e.template_effect(()=>e.set_text(re,` ${e.get(L).unit??""} |  `)),e.append(R,U)};e.if(N,R=>{e.get(L).index!=null&&R(ee)})}e.append(D,V)}),e.append(d,c)},j=d=>{var c=e.comment(),F=e.first_child(c);{var D=V=>{var N=e.text();e.template_effect(()=>e.set_text(N,`queue: ${t.queue_position+1}/${t.queue_size??""} |`)),e.append(V,N)},L=V=>{var N=e.comment(),ee=e.first_child(N);{var R=U=>{var te=e.text("processing |");e.append(U,te)};e.if(ee,U=>{t.queue_position===0&&U(R)},!0)}e.append(V,N)};e.if(F,V=>{t.queue_position!==null&&t.queue_size!==void 0&&t.queue_position>=0?V(D):V(L,!1)},!0)}e.append(d,c)};e.if(S,d=>{n()?d(C):d(j,!1)})}var W=e.sibling(S,2);{var oe=d=>{var c=e.text();e.template_effect(()=>e.set_text(c,`${e.get($)??""}${a()?`/${e.get(K)}`:""}s`)),e.append(d,c)};e.if(W,d=>{p()&&d(oe)})}e.reset(w);var B=e.sibling(w,2);{var Pe=d=>{var c=it(),F=e.child(c),D=e.child(F);{var L=R=>{var U=e.comment(),te=e.first_child(U);e.each(te,17,n,e.index,(be,ae,re)=>{var H=e.comment(),J=e.first_child(H);{var de=ve=>{var Le=lt(),Me=e.first_child(Le);{var Se=M=>{var G=e.text("Â /");e.append(M,G)};e.if(Me,M=>{re!==0&&M(Se)})}var ke=e.sibling(Me,2);{var Be=M=>{var G=e.text();e.template_effect(()=>e.set_text(G,e.get(ae).desc)),e.append(M,G)};e.if(ke,M=>{e.get(ae).desc!=null&&M(Be)})}var Ve=e.sibling(ke,2);{var Xe=M=>{var G=e.text("-");e.append(M,G)};e.if(Ve,M=>{e.get(ae).desc!=null&&e.get(I).progress_level&&e.get(I).progress_level[re]!=null&&M(Xe)})}var Ye=e.sibling(Ve,2);{var De=M=>{var G=e.text();e.template_effect(Ne=>e.set_text(G,`${Ne??""}%`),[()=>(100*(e.get(I).progress_level[re]||0)).toFixed(1)]),e.append(M,G)};e.if(Ye,M=>{e.get(I).progress_level!=null&&M(De)})}e.append(ve,Le)};e.if(J,ve=>{(e.get(ae).desc!=null||e.get(I).progress_level&&e.get(I).progress_level[re]!=null)&&ve(de)})}e.append(be,H)}),e.append(R,U)};e.if(D,R=>{n()!=null&&R(L)})}e.reset(F);var V=e.sibling(F,2),N=e.child(V);let ee;e.reset(V),e.reset(c),e.template_effect(()=>ee=e.set_style(N,"",ee,{width:`${e.get(I).last_progress_level*100}%`,transition:e.get(I).progress_bar_transition})),e.append(d,c)},Ze=d=>{var c=e.comment(),F=e.first_child(c);{var D=L=>{{let V=e.derived(()=>m()==="default");$e(L,{get margin(){return e.get(V)}})}};e.if(F,L=>{v()==="full"&&L(D)},!0)}e.append(d,c)};e.if(B,d=>{e.get(I).last_progress_level!=null?d(Pe):d(Ze,!1)})}var ze=e.sibling(B,2);{var Ee=d=>{var c=nt(),F=e.first_child(c),D=e.child(F,!0);e.reset(F);var L=e.sibling(F,2);e.slot(L,t,"additional-loading-text",{},null),e.template_effect(()=>e.set_text(D,z())),e.append(d,c)};e.if(ze,d=>{p()||d(Ee)})}e.template_effect(()=>Z=e.set_class(w,1,"progress-text svelte-1uj8rng",null,Z,{"meta-text-center":m()==="center","meta-text":m()==="default"})),e.append(o,u)},P=o=>{var u=e.comment(),f=e.first_child(u);{var _=w=>{var Z=dt(),S=e.first_child(Z),C=e.child(S);{let B=e.derived(()=>t.i18n("common.clear"));je(C,{get Icon(){return Te},get label(){return e.get(B)},disabled:!1,$$events:{click:()=>{t.on_clear_status?.()}}})}e.reset(S);var j=e.sibling(S,2),W=e.child(j,!0);e.reset(j);var oe=e.sibling(j,2);e.slot(oe,t,"error",{},null),e.template_effect(B=>e.set_text(W,B),[()=>t.i18n("common.error")]),e.append(w,Z)};e.if(f,w=>{t.status==="error"&&w(_)},!0)}e.append(o,u)};e.if(r,o=>{t.status==="pending"?o(g):o(P,!1)})}e.reset(Y),e.bind_this(Y,o=>q=o,()=>q),e.template_effect(()=>{ne=e.set_class(Y,1,`wrap ${m()??""} ${v()??""}`,"svelte-1uj8rng",ne,{"no-click":s()&&x(),hide:e.get(pe),translucent:m()==="center"&&(t.status==="pending"||t.status==="error")||T()||v()==="minimal"||s(),generating:t.status==="generating"&&v()==="full",border:h()}),ue=e.set_style(Y,"",ue,{position:E()?"absolute":"static",padding:E()?"0":"var(--size-8) 0"})}),e.append(l,Y),e.pop()}const ft=(l,t=location.href)=>{try{return!!l&&new URL(l).origin!==new URL(t).origin}catch{return!1}};function _t(l){const t=new Je,a=new DOMParser().parseFromString(l,"text/html");return Ie(a.body,"A",i=>{i instanceof HTMLElement&&"target"in i&&ft(i.getAttribute("href"),location.href)&&(i.setAttribute("target","_blank"),i.setAttribute("rel","noopener noreferrer"))}),t.sanitize(a).body.innerHTML}function Ie(l,t,a){l&&(l.nodeName===t||typeof t=="function")&&a(l);const i=l?.childNodes||[];for(let p=0;p<i.length;p++)Ie(i[p],t,a)}var ct=e.from_html('<span class="toast-count svelte-irmu64"> </span>'),ut=e.from_html('<div class="toast-separator svelte-irmu64"></div>'),gt=e.from_html('<div><div data-testid="toast-text"><!></div></div> <!>',1),mt=e.from_html('<div class="toast-messages svelte-irmu64"></div>'),pt=e.from_html("<div></div>"),ht=e.from_html('<div role="status" aria-live="polite" data-testid="toast-body"><div class="toast-header svelte-irmu64" role="button" tabindex="0"><div><!></div> <div class="toast-title-row svelte-irmu64"><span> <!></span> <div><!></div></div> <button type="button" aria-label="Close" data-testid="toast-close"><span aria-hidden="true">&#215;</span></button></div> <!> <!></div>');function xt(l,t){e.push(t,!0);let a=e.prop(t,"messages",19,()=>[]),i=e.prop(t,"expanded",3,!0),p=e.state(0),v=e.state(0),y=e.state(0),n=e.state(!1),m,z=e.derived(()=>a().length),E=e.derived(()=>a()[0]),T=e.derived(()=>t.type.charAt(0).toUpperCase()+t.type.slice(1)),h=e.derived(()=>e.get(E)?.duration!==null),s=e.derived(()=>e.get(h)?`${e.get(E).duration}s`:"0s");function x(){t.ontoggle?.()}function k(){a().forEach(r=>{t.onclose?.(r.id)})}function q(r){e.set(p,r.touches[0].clientX,!0),e.set(v,r.touches[0].clientY,!0),e.set(n,!0)}function X(r){if(!e.get(n))return;const g=r.touches[0].clientX,P=r.touches[0].clientY,o=g-e.get(p),u=P-e.get(v);Math.abs(o)>Math.abs(u)&&Math.abs(o)>10&&(r.preventDefault(),e.set(y,o))}function se(){e.get(n)&&(Math.abs(e.get(y))>100?k():e.set(y,0),e.set(n,!1))}e.user_effect(()=>{e.get(h)&&a().length===1&&setTimeout(k,e.get(E).duration*1e3)});var b=ht();b.__touchstart=q,b.__touchmove=X,b.__touchend=se;var A=e.child(b);A.__click=x,A.__keydown=r=>{(r.key==="Enter"||r.key===" ")&&x()};var O=e.child(A),K=e.child(O);{var pe=r=>{He(r)},Q=r=>{var g=e.comment(),P=e.first_child(g);{var o=f=>{Ge(f)},u=f=>{var _=e.comment(),w=e.first_child(_);{var Z=C=>{Oe(C)},S=C=>{var j=e.comment(),W=e.first_child(j);{var oe=B=>{We(B)};e.if(W,B=>{t.type==="error"&&B(oe)},!0)}e.append(C,j)};e.if(w,C=>{t.type==="success"?C(Z):C(S,!1)},!0)}e.append(f,_)};e.if(P,f=>{t.type==="info"?f(o):f(u,!1)},!0)}e.append(r,g)};e.if(K,r=>{t.type==="warning"?r(pe):r(Q,!1)})}e.reset(O);var le=e.sibling(O,2),$=e.child(le),fe=e.child($),_e=e.sibling(fe);{var I=r=>{var g=ct(),P=e.child(g);e.reset(g),e.template_effect(()=>e.set_text(P,`(${e.get(z)??""})`)),e.append(r,g)};e.if(_e,r=>{e.get(z)>1&&r(I)})}e.reset($);var ie=e.sibling($,2);let ce;var he=e.child(ie);Ue(he),e.reset(ie),e.reset(le);var Y=e.sibling(le,2);Y.__click=r=>{r.stopPropagation(),k()},e.reset(A);var ne=e.sibling(A,2);{var ue=r=>{var g=mt();e.each(g,23,a,P=>P.id,(P,o,u)=>{var f=gt(),_=e.first_child(f),w=e.child(_),Z=e.child(w);e.html(Z,()=>_t(e.get(o).message)),e.reset(w),e.reset(_);var S=e.sibling(_,2);{var C=j=>{var W=ut();e.append(j,W)};e.if(S,j=>{e.get(u)<a().length-1&&j(C)})}e.template_effect(()=>{e.set_class(_,1,`toast-message-item ${t.type??""}`,"svelte-irmu64"),e.set_class(w,1,`toast-message-text ${t.type??""}`,"svelte-irmu64")}),e.append(P,f)}),e.reset(g),e.transition(3,g,()=>Ke,()=>({duration:200})),e.append(r,g)};e.if(ne,r=>{i()&&r(ue)})}var ge=e.sibling(ne,2);{var xe=r=>{var g=pt();e.template_effect(()=>{e.set_class(g,1,`timer ${t.type??""}`,"svelte-irmu64"),e.set_style(g,`animation-duration: ${e.get(s)??""}`)}),e.append(r,g)};e.if(ge,r=>{e.get(h)&&r(xe)})}e.reset(b),e.bind_this(b,r=>m=r,()=>m),e.template_effect(r=>{e.set_class(b,1,`toast-body ${t.type??""}`,"svelte-irmu64"),e.set_style(b,`transform: translateX(${e.get(y)??""}px); opacity: ${r??""};`),e.set_class(O,1,`toast-icon ${t.type??""}`,"svelte-irmu64"),e.set_class($,1,`toast-title ${t.type??""}`,"svelte-irmu64"),e.set_text(fe,`${e.get(T)??""} `),ce=e.set_class(ie,1,"chevron svelte-irmu64",null,ce,{expanded:i(),visible:e.get(z)>0}),e.set_class(Y,1,`toast-close ${t.type??""}`,"svelte-irmu64")},[()=>1-Math.abs(e.get(y))/300]),e.transition(1,b,()=>qe,()=>({duration:200,delay:100})),e.transition(2,b,()=>qe,()=>({duration:200})),e.append(l,b),e.pop()}e.delegate(["touchstart","touchmove","touchend","click","keydown"]);var bt=e.from_html('<div class="toast-item svelte-1qhecvt"><!></div>'),yt=e.from_html('<div class="toast-wrap svelte-1qhecvt"></div>');function At(l,t){e.push(t,!0);const a=()=>e.store_get(y,"$top",i),[i,p]=e.setup_stores();let v=e.prop(t,"messages",19,()=>[]);const y=Fe(0,{stiffness:.4,damping:.5});let n=e.state(e.proxy([]));e.user_effect(()=>{z(v())}),e.user_effect(()=>{e.set(n,m(v()),!0)});function m(h){const s=new Map;return h.forEach(x=>{const k=x.type;s.has(k)||s.set(k,{type:x.type,messages:[],expanded:!0}),s.get(k).messages.push(x)}),Array.from(s.values())}function z(h){h.length>0&&"parentIFrame"in window&&window.parentIFrame?.getPageInfo(s=>{s.scrollTop<s.offsetTop?y.set(0):y.set(s.scrollTop-s.offsetTop)})}function E(h){e.set(n,e.get(n).map(s=>s.type===h?{...s,expanded:!s.expanded}:s),!0)}var T=yt();e.each(T,21,()=>e.get(n),h=>h.type,(h,s)=>{var x=bt(),k=e.child(x);xt(k,{get type(){return e.get(s).type},get messages(){return e.get(s).messages},get expanded(){return e.get(s).expanded},ontoggle:()=>E(e.get(s).type),onclose:q=>t.on_close(q)}),e.reset(x),e.append(h,x)}),e.reset(T),e.template_effect(()=>e.set_style(T,`--toast-top: ${a()??""}px;`)),e.append(l,T),e.pop(),p()}var wt=e.from_html('<div class="streaming-bar svelte-1au5sp1"></div>');function It(l,t){var a=e.comment(),i=e.first_child(a);{var p=v=>{var y=wt();let n;e.template_effect(()=>n=e.set_style(y,"",n,{"animation-duration":`${t.time_limit??""}s`})),e.append(v,y)};e.if(i,v=>{t.time_limit&&v(p)})}e.append(l,a)}export{$e as L,qt as S,At as T,It as a};
